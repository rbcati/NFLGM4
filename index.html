<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NFL GM Simulator </title>
    <link rel="stylesheet" href="style.css" />
 <!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NFL GM Simulator</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- your existing markup stays the same -->

    <!-- Order matters. Load helpers first, then your app code. -->
<script src="constants.js"></script>
<script src="teams.js"></script>
<script src="utils.js"></script>
<script src="schedule.js"></script>

<script src="state.js"></script>
<script src="player.js"></script>
<script src="cap.js"></script>
<script src="picks.js"></script>
<script src="league.js"></script>
<script src="simulation.js"></script>
<script src="playoffs.js"></script>
<script src="trade.js"></script>
<script src="freeAgency.js"></script>
<script src="draft.js"></script>
<script src="offseason.js"></script>
<script src="training.js"></script>
<script src="ui.js"></script>
<script src="events.js"></script>
<script src="main.js"></script>
<header class="topbar" role="navigation">
  <div class="brand">NFL GM</div>
  <script>
  (function () {
    const pills = document.getElementById('site-nav');
    const toggle = document.querySelector('.nav-toggle');
    const views = Array.from(document.querySelectorAll('.view'));

    function showView(id) {
      views.forEach(v => v.toggleAttribute('hidden', v.id !== id));
      document.querySelectorAll('.nav-pill').forEach(a => {
        a.setAttribute('aria-current', a.dataset.view === id ? 'page' : null);
      });
    }

    function initFromHash() {
      const id = (location.hash || '#hub').slice(1);
      showView(document.getElementById(id) ? id : 'hub');
    }

    document.addEventListener('click', e => {
      const a = e.target.closest('.nav-pill');
      if (a && a.dataset.view) {
        e.preventDefault();
        const id = a.dataset.view;
        if (location.hash !== '#' + id) history.replaceState(null, '', '#' + id);
        showView(id);
        if (pills && pills.classList.contains('open')) {
          pills.classList.remove('open');
          toggle?.setAttribute('aria-expanded', 'false');
        }
      }
    });

    toggle?.addEventListener('click', () => {
      const open = pills.classList.toggle('open');
      toggle.setAttribute('aria-expanded', String(open));
    });

    window.addEventListener('hashchange', initFromHash);
    initFromHash();
  })();
</script>


  <nav id="site-nav" class="nav-pills" aria-label="Primary">
    <a href="#hub"        class="nav-pill" data-view="hub"        aria-label="Home"         title="Home">
      <!-- Home -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-10.5Z" fill="currentColor"/></svg>
      <span class="label">Home</span>
    </a>

    <a href="#roster"     class="nav-pill" data-view="roster"     aria-label="Roster"       title="Roster">
      <!-- Roster -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm-8 8a8 8 0 0 1 16 0Z" fill="currentColor"/></svg>
      <span class="label">Roster</span>
    </a>

    <a href="#trade"      class="nav-pill" data-view="trade"      aria-label="Trades"       title="Trades">
      <!-- Trades -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M7 7h11l-3-3 1.5-1.5L22 7l-5.5 4.5L15 10l3-3H7V7Zm10 10H6l3 3-1.5 1.5L2 17l5.5-4.5L9 14l-3 3h11v0Z" fill="currentColor"/></svg>
      <span class="label">Trades</span>
    </a>

    <a href="#standings"  class="nav-pill" data-view="standings"  aria-label="Standings"    title="Standings">
      <!-- Standings -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M4 13h4v8H4v-8Zm6-6h4v14h-4V7Zm6-4h4v18h-4V3Z" fill="currentColor"/></svg>
      <span class="label">Standings</span>
    </a>

    <a href="#freeagency" class="nav-pill" data-view="freeagency" aria-label="Free Agency"  title="Free Agency">
      <!-- Free Agency -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M12 3a4 4 0 1 1-4 4 4 4 0 0 1 4-4Zm7 18H5a1 1 0 0 1-1-1 8 8 0 0 1 16 0 1 1 0 0 1-1 1Z" fill="currentColor"/></svg>
      <span class="label">Free</span>
    </a>

    <a href="#draft"      class="nav-pill" data-view="draft"      aria-label="Draft"        title="Draft">
      <!-- Draft -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 12l9-9 9 9-9 9-9-9Zm9-5 5 5-5 5-5-5 5-5Z" fill="currentColor"/></svg>
      <span class="label">Draft</span>
    </a>

    <a href="#settings"   class="nav-pill" data-view="settings"   aria-label="Settings"     title="Settings">
      <!-- Settings -->
      <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M19.4 12.97a7.6 7.6 0 0 0 .05-.97 7.6 7.6 0 0 0-.05-.97l2.11-1.65a.5.5 0 0 0 .12-.64l-2-3.46a.5.5 0 0 0-.6-.22l-2.49 1a7.83 7.83 0 0 0-1.68-.97l-.38-2.65A.5.5 0 0 0 12 0h-4a.5.5 0 0 0-.5.42l-.38 2.65c-.6.25-1.16.57-1.68.97l-2.49-1a.5.5 0 0 0-.6.22l-2 3.46a.5.5 0 0 0 .12.64L2.4 11.03a7.6 7.6 0 0 0-.05.97 7.6 7.6 0 0 0 .05.97L.29 14.62a.5.5 0 0 0-.12.64l2 3.46a.5.5 0 0 0 .6.22l2.49-1c.52.4 1.08.72 1.68.97l.38 2.65A.5.5 0 0 0 8 22h4a.5.5 0 0 0 .5-.42l.38-2.65c.6-.25 1.16-.57 1.68-.97l2.49 1a.5.5 0 0 0 .6-.22l2-3.46a.5.5 0 0 0-.12-.64L19.4 12.97ZM10 12a2 2 0 1 1 2 2 2 2 0 0 1-2-2Z" fill="currentColor"/></svg>
      <span class="label">Settings</span>
    </a>
  </nav>

  <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav" aria-label="Toggle menu">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
  </button>
</header>




    <main class="layout">
      <aside class="sidebar">
        <div class="section">
          <label for="userTeam">Your Team</label>
          <select id="userTeam"></select>
        </div>
        <div class="section">
          <div>Season <span id="seasonNow"></span></div>
          <div>Cap Used: <span id="capUsed"></span> / <span id="capTotal"></span></div>
          <div class="muted small">Dead Cap: <span id="deadCap"></span></div>
          <div class="muted small">Room: <span id="capRoom"></span></div>
        </div>
        <div class="section">
          <button id="btnSave" class="btn">Save</button>
          <button id="btnLoad" class="btn">Load</button>
        </div>
        <div class="section muted" id="statusMsg"></div>
      </aside>

      <section class="content">
        <section id="hub" class="view">
          <div class="card">
            <div class="row">
              <h2>League Hub</h2>
              <div class="spacer"></div>
              <div class="muted">Season <span id="hubSeason"></span></div>
            </div>
            <div class="grid two">
              <div>
                <div>Week <span id="hubWeek"></span> of <span id="hubWeeks"></span></div>
                <div>Games this week: <span id="hubGames"></span></div>
                <div class="actions">
                  <button id="btnSimWeek" class="btn primary">Simulate Week</button>
                  <button id="btnSimSeason" class="btn">Sim Season</button>
                </div>
              </div>
              <div>
                <h3>Power Ranking</h3>
                <ol id="hubPower"></ol>
              </div>
            </div>
          </div>
          <div class="card">
            <h3>Last Week Results</h3>
            <div id="hubResults" class="list"></div>
          </div>
          <div class="card">
            <h3>Trade Offers</h3>
            <div id="hubOffers" class="list"></div>
          </div>

        </section>

        <section id="roster" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2 id="rosterTitle">Roster</h2>
              <div class="spacer"></div>
              <label for="rosterTeam">Team</label>
              <select id="rosterTeam"></select>
            </div>
            <table class="table" id="rosterTable"></table>
            <div class="row mt">
              <label class="row"><input type="checkbox" id="postJune1"> Post June 1 release</label>
              <div class="spacer"></div>
              <button id="btnRelease" class="btn danger">Release Selected</button>
            </div>
          </div>
          <div class="card">
            <h3>Depth Chart</h3>
            <div id="depthChart" class="list"></div>
          </div>
        </section>

        <section id="cap" class="view" hidden>
          <div class="card">
            <h2>Cap Table</h2>
            <div id="capSummary" class="muted"></div>
            <table class="table" id="capTable"></table>
          </div>
          <div class="card">
            <h3>Dead Cap Ledger</h3>
            <div id="deadLedger" class="list"></div>
          </div>
        </section>

        <section id="schedule" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2>Schedule</h2>
              <div class="spacer"></div>
              <button id="btnSimWeek2" class="btn primary">Simulate Week</button>
            </div>
            <div id="scheduleList" class="list"></div>
          </div>
        </section>

        <section id="standings" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2>Standings</h2>
              <div class="spacer"></div>
              <select id="standingsScope">
                <option value="league">League</option>
                <option value="conference">Conference</option>
                <option value="division">Division</option>
              </select>
            </div>
              <div class="row mt">
                <label class="row"><input type="checkbox" id="leadersOnly"> Leaders only</label>
                <label class="row"><input type="checkbox" id="highlightLeaders" checked> Highlight leaders</label>
                <div class="spacer"></div>
                <button id="btnPlayoffPicture" class="btn">Playoff picture</button>
              </div>

            <div id="standingsWrap"></div>
          <div class="card" id="playoffPicture" hidden>
            <h3>Playoff picture</h3>
            <div class="grid two">
              <div>
                <h4>AFC seeds</h4>
                <ol id="seedsAFC"></ol>
              </div>
              <div>
                <h4>NFC seeds</h4>
                <ol id="seedsNFC"></ol>
              </div>
            </div>
            <div class="muted small">Top seed in each conference has a bye. Wild Card round: 2v7, 3v6, 4v5.</div>
          </div>

          </div>
        </section>

        <section id="trade" class="view" hidden>
          <div class="card">
            <h2>Trade Center</h2>
            <div class="grid two">
              <div>
                <label for="tradeA">Team A</label>
                <select id="tradeA"></select>
                <div class="small muted">Players</div>
                <div id="tradeListA" class="list"></div>
                <div class="small muted mt">Picks</div>
                <div id="pickListA" class="list"></div>
              </div>
              <div>
                <label for="tradeB">Team B</label>
                <select id="tradeB"></select>
                <div class="small muted">Players</div>
                <div id="tradeListB" class="list"></div>
                <div class="small muted mt">Picks</div>
                <div id="pickListB" class="list"></div>
              </div>
            </div>
            <div class="row mt">
              <button id="btnSuggest" class="btn">Suggest trades for Team A</button>
              <div class="spacer"></div>
              <div id="tradeInfo" class="muted"></div>
              <div class="spacer"></div>
              <button id="tradeValidate" class="btn">Validate</button>
              <button id="tradeExecute" class="btn primary" disabled>Execute</button>
            </div>
          </div>
        </section>

        <section id="freeagency" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2>Free Agency</h2>
              <div class="spacer"></div>
              <label for="faTeam">Sign to</label>
              <select id="faTeam"></select>
            </div>
            <table class="table" id="faTable"></table>
            <div class="row mt">
              <button id="btnSignFA" class="btn primary" disabled>Sign Selected</button>
            </div>
          </div>
        </section>

        <section id="draft" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2>Draft Picks</h2>
              <div class="spacer"></div>
              <label for="draftTeam">Team</label>
              <select id="draftTeam"></select>
            </div>
            <div id="draftPicks" class="list"></div>
            <div class="muted small">The full multi round draft flow will be added next. Picks can already be traded.</div>
          </div>
        </section>

        <section id="playoffs" class="view" hidden>
          <div class="card">
            <div class="row">
              <h2>Playoffs</h2>
              <div class="spacer"></div>
              <button id="btnSimRound" class="btn primary">Simulate Next Round</button>
            </div>
            <div id="playoffState" class="muted"></div>
            <div id="playoffBracket" class="list"></div>
            <div id="playoffResults" class="list mt"></div>
          </div>
        </section>

        <section id="settings" class="view" hidden>
          <div class="card">
            <h2>Settings</h2>
            <div class="card">
              <h3>League Year</h3>
              <div class="row">
                <label for="settingsYear">Year</label>
                <input id="settingsYear" type="number" min="1930" max="9999" style="width:120px" />
                <div class="spacer"></div>
                <button id="btnApplyYear" class="btn danger">Apply Year</button>
              </div>
              <div class="muted small">Changing the year reseeds the schedule and resets the current week. Records and rosters remain.</div>
            </div>
    
            <div class="card">
              <h3>Teams & Names</h3>
              <div class="row">
                <label class="row"><input type="radio" name="settingsNamesMode" value="fictional"> Fictional names</label>
                <label class="row"><input type="radio" name="settingsNamesMode" value="real"> Real names</label>
                <div class="spacer"></div>
                <button id="btnApplyNamesMode" class="btn">Apply</button>
              </div>
              <div class="muted small">Switching names keeps records and rosters. Abbreviations remain generic.</div>
            </div>

            <div class="row">
              <button id="btnNewLeague" class="btn danger">Start New League</button>
              <div class="spacer"></div>
              <button class="btn" onclick="history.back()">Back</button>
            </div>
          </div>
        </section>
      </section>
    </main>

    
    <div id="onboardModal" class="modal" hidden>
      <div class="modal-card">
        <div class="row">
          <h3>Start New League</h3>
          <div class="spacer"></div>
          <button id="onboardClose" class="btn">Close</button>
        </div>
        <div class="row mt">
          <label class="row"><input type="radio" name="namesMode" value="fictional" checked> Fictional team names</label>
          <label class="row"><input type="radio" name="namesMode" value="real"> Real NFL team names</label>
        </div>
        <div class="row mt">
          <label for="onboardYear">Start Year</label>
          <input id="onboardYear" type="number" min="1930" max="9999" value="2025" style="width:120px" />
        </div>
        <div class="row mt">
          <label for="onboardTeam">Choose your team</label>
          <select id="onboardTeam"></select>
          <button id="onboardRandom" class="btn">Random</button>
        </div>
        <div class="row mt">
          <button id="onboardStart" class="btn primary">Start Season</button>
        </div>
        <div class="muted small">You must pick a team before playing. Real names are text only, no logos.</div>
      </div>
    </div>

    <footer class="footer">
      <div>Contracts 2.0 and pick trading are live. Rollover applies each offseason.</div>
    </footer>

  </body>
</html>
